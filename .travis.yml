sudo: false
language: python
cache:
  directories:
    - $HOME/.cache/pip
git:
  submodules: false

matrix:
  include:
    - python: 2.7
      env: TOXENV=py27
    - python: 3.5
      env: TOXENV=py35
    - python: 3.6
      env: TOXENV=py36
    - python: 3.7
      env: TOXENV=py37
      dist: xenial
      sudo: true
    - python: 3.8
      env: TOXENV=py38
      dist: xenial
      sudo: true
    - python: nightly
      dist: bionic
      sudo: true
      env: TOXENV=py39
    - name: Python 3.7.4 on macOS
      os: osx
      osx_image: xcode11.2
      language: shell
      env:
        - TOXENV=py37
        - PYTHONUSERBASE=$HOME/.local
        - PATH=$PYTHONUSERBASE/bin:$PATH
    # - name: Python 2.7 on Windows
    #   os: windows
    #   language: shell
    #   before_install:
    #     - choco install python2 --version 2.7.17
    #     - python -m pip install --upgrade pip
    #   env:
    #     - PATH=/c/Python27:/c/Python27/Scripts:/c/Users/travis/AppData/Roaming/Python/Python27/Scripts/bin:$PATH
    #     - TOXENV=py27
    # - name: Python 3.8.2 on Windows
    #   os: windows
    #   language: shell
    #   before_install:
    #     - choco install python --version 3.8.2
    #     - python -m pip install --upgrade pip
    #   env:
    #     - PATH=/c/Python38:/c/Python38/Scripts:/c/Users/travis/AppData/Roaming/Python/Python38/Scripts/bin:$PATH
    #     - TOXENV=py38
  allow_failures:
    - python: nightly

install:
  - git submodule update --init --recursive
  - if [ "$TRAVIS_OS_NAME" = "osx" ]; then
      pip install --user -r requirements-dev.txt;
    else
      pip install -r requirements-dev.txt;
    fi

script:
  - tox -e $TOXENV
